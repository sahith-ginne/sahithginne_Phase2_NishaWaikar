package com.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.HashSet;
import java.util.Set;

import com.dto.flights;
import com.util.ConnectionManagerImpl;

public class FlyawayDaoImpl implements FlyawayDao {
	private Connection connection;
	public FlyawayDaoImpl(){
		connection = new ConnectionManagerImpl().getConnection();
	}

	@Override
	public boolean addflights(flights flights) {
		boolean isStudentRecordInserted = false;
		String airlines = flights.getairlines();
		String Arival = flights.getArival();
		String Departure = flights.getDeparture();
		String city = flights.getCity();

		
		String sql = "insert into flights values(?, ?, ?, ?)";
		try {
			PreparedStatement preparedStatement = connection.prepareStatement(sql);
			preparedStatement.setString(1, airlines);
			preparedStatement.setString(2, Arival);
			preparedStatement.setString(3, Departure);
			preparedStatement.setString(4, city);
			int value = preparedStatement.executeUpdate();
			if(value > 0)
				isStudentRecordInserted = true;
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
		return isStudentRecordInserted;
	}

	@Override
	public boolean updateflights(String airlines, String city) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean deleteflights(String airlines) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public flights searchflights(String airlines) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public Set<flights> getAllflights() {
		Set<flights> fset = new HashSet<>();
		String sql = "select * from flights";
		try {
			Statement statement = connection.createStatement();
			ResultSet resultSet = statement.executeQuery(sql);
			while(resultSet.next()) {
				
				
				String airlines = resultSet.getString(1);
				String Arival = resultSet.getString(2);
				String Departure = resultSet.getString(3);
				String city = resultSet.getString(4);
				flights res = new flights(airlines, Arival, Departure, city);
				fset.add(res);				
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return fset;
	}

}
